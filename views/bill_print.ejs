<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Shourya Fashion Hub - Bill</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f9fa;
      color: #222;
      margin: 0;
      padding:20px;
    }

    .bill-container {
      max-width: 420px;
      margin: 30px auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(44, 62, 80, 0.10);
      padding: 32px 28px 24px 28px;
      border: 1.5px solid #000;
    }

    .bill-header {
      text-align: center;
      margin-bottom: 18px;
    }

    @media print {
      .bill-header h2 {
        background: none !important;
        -webkit-background-clip: initial !important;
        -webkit-text-fill-color: #000 !important;
        color: #000 !important;
      }
    }

    img {
      max-width: 100%;
      width:150px;
      height: 170px;
      /* margin-top:80px; */
      position: relative;
      top: 30px;
    }

    .bill-header .shop-address {
      font-size: 0.95rem;
      color: #000;
      margin-top: 2px;
      margin-bottom: 2px;
    }

    .bill-info {
      font-size: 1rem;
      margin-bottom: 10px;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      border-bottom: 1px dashed #bfc9d1;
      padding-bottom: 8px;
    }

    .bill-info span {
      min-width: 48%;
      margin-bottom: 2px;
    }

    .bill-table {
      width: 100%;
      border-collapse: collapse;
      margin: 18px 0 10px 0;
      font-size: 0.98rem;
    }

    .bill-table th,
    .bill-table td {
      border: 1px solid #000;
      padding: 7px 6px;
      text-align: center;
    }

    .bill-table th {
      background: #f6f8fa;
      font-weight: 700;
      color: #000;
      font-size: 1rem;
    }

    .bill-table tr:nth-child(even) td {
      background: #fafbfc;
    }

    .bill-summary {
      margin-top: 10px;
      margin-bottom: 10px;
      font-size: 1.05rem;
    }

    .bill-summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 3px;
    }

    .bill-summary-row strong {
      font-weight: 600;
    }

    .bill-footer {
      text-align: center;
      margin-top: 18px;
      font-size: 1.1rem;
      color: #000;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    @media print {
      body {
        background: #fff;
        font-size: 10px;
        margin: 0;
        padding: 0;
      }

      .bill-container {
        width: 58mm;
        /* Exact width for thermal printer */
        max-width: none;
        margin: 0 auto;
        padding: 6px;
        box-shadow: none;
        border: none;
      }

      .bill-header h2 {
        font-size: 1.2rem;
      }

      .shop-address,
      .bill-info,
      .bill-summary,
      .bill-footer {
        font-size: 0.75rem;
      }

      .bill-table {
        font-size: 0.72rem;
        margin: 6px 0;
      }

      .bill-table th {
        font-size: 0.75rem;
        padding: 4px;
      }

      .bill-table td {
        padding: 3px;
      }

      @page {
        size: 58mm auto;
        margin: 0;
      }
    }
  </style>
</head>

<body>

  <div class="bill-container">

    <div class="bill-header">
      <!-- <h2>Shourya Fashion Hub</h2> -->
      <div class="shop-address">
        <div style="text-align:center; margin-bottom:4px;">
          <img src="/logo/first_logo.jpg" alt="Shourya Fashion Hub Logo" style="max-height:100px; max-width:100%; margin-top:-30px; " />

        </div>
        <h2>Shourya Fashion Hub</h2>
      <span style=" font-weight:600; position: relative; top: -15px;"> Omkar Bhawar,&nbsp;7262836111</span>
      </div>
      <hr style="border: 1px solid #000;  position: relative; top: -10px; ">
    </div>
    <div class="bill-info" style="position: relative; top: -14px;">
      <span><strong>Date & Time:</strong>
        <%= new Date().toLocaleString("en-IN") %>
      </span>
      <span><strong>Bill No:</strong>
        <%= data[0].id %>
      </span>
      <span><strong>Customer:</strong>
        <%= data[0].customer_name %>
      </span>
      <span><strong>Mobile:</strong>
        <%= data[0].mobile %>
      </span>
    </div>
    <% let subtotal=0, totalQty=0, totalDiscount=0, finalTotal=0; %>
      <table class="bill-table" style="position: relative; top: -10px;">
        <thead>
          <tr>
            <th>Product</th>
            <th>Size</th>
            <th>Qty</th>
            <th>Rate</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          <% data.forEach(item=> { %>
            <% if (!item.product || !item.quantity) return; %>
              <% subtotal +=parseFloat(item.amount); %>
                <% totalQty +=parseInt(item.quantity); %>
                  <% totalDiscount +=parseFloat(item.discount_amount); %>
                    <% finalTotal +=parseFloat(item.Total_after_Discount); %>
                      <tr>
                        <td>
                          <%= item.product %>
                        </td>
                        <td>
                          <%= item.size %>
                        </td>
                        <td>
                          <%= item.quantity %>
                        </td>
                        <td>‚Çπ<%= parseFloat(item.price_per_unit).toFixed(2) %>
                        </td>
                        <td>‚Çπ<%= parseFloat(item.amount).toFixed(2) %>
                        </td>
                      </tr>
                      <% }); %>
        </tbody>
      </table>
      <div class="bill-summary">
        <div class="bill-summary-row">
          <span>Subtotal</span>
          <strong>‚Çπ<%= subtotal.toFixed(2) %></strong>
        </div>
        <div class="bill-summary-row">
          <span>Total Quantity</span>
          <strong>
            <%= totalQty %>
          </strong>
        </div>
        <div class="bill-summary-row">
          <span>Discount</span>
          <strong>‚Çπ<%= totalDiscount.toFixed(2) %></strong>
        </div>
        <div class="bill-summary-row" style="font-size:1.13rem;">
          <span>Total After Discount</span>
          <strong>‚Çπ<%= finalTotal.toFixed(2) %></strong>
        </div>
      </div>
      <div class="bill-footer">
        Thank You üôè Visit Again!
      </div>
  </div>
  <script>
    window.print();
    setTimeout(() => {
      window.location.href = "/billing_page";
    }, 1000);
  </script>
</body>

</html>
